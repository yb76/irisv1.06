{TYPE:DISPLAY,NAME:iPAY_TRANS,GROUP:iPAY,VERSION:1.0,NEW_OBJECT:[[NAME,TXN],[MMER,/MMER/ELECT],[ACCOUNT,~ACCOUNT],[FUNC,/iPAY/FUNCTION],[AMOUNT,~TOTAL],[PAN,~PAN],[EXPIRY,~EXPIRY],[CCV,~CCV],[CCI,~CCI],[ECMm,~ECMm],[ECMt,~ECMt],[EFB,~EFB],[TRACK2,~TRACK2],[CASH,[[~CASH,>0,,~CASH]]],[PTIP,[[~PTIP,>0,,~PTIP]]],[AUTHID,~AUTHID],[INVNO,[()FMT,06,~INVNO]],[PINBLOCK,~PINBLOCK],[ACCTSEL,~ACCOUNTSELECTED],[TIME,[[/iPAY_TRANS/TIME,,,/iPAY_TRANS/TIME],()NOW]]],START_LOOP:[[,,{~length:[()LEN,[[/TXN/TRACK2,,,/TXN/TRACK2<=|-1|],/TXN/PAN]]},]],END_LOOP:[[~length,>5,{~length--:},LOOP]],VALUE_H1:?{{/iECRD/HEADER;;;/iECRD/HEADER_READY};/MERCHANT()/RECEIPT_HEADER}?,VALUE_H2:?{{/iECRD/HEADER_OK;;;{{~RESULT;!DEC;;{{~RESULT;!CAN;;/iECRD/HEADER_OK_READY}}}}}}?,VALUE_AUTHID:[[~RESULT,!CAN,{~LEN:[()LEN,/TXN/AUTHID]},[[~LEN,!0,,[AUTH NO: \R,()FMT,06,/TXN/AUTHID,\n]]]]],VALUE:\C\F?{{/iECRD/HEADER;NULL;;\H}}??~WHO?\4\W\C?/MERCHANT()/ADDR1?\n\C?{{/MERCHANT()/ADDR2;;;{/MERCHANT()/ADDR2;\n}}}?\C?{{/MERCHANT()/ADDR3;;;{/MERCHANT()/ADDR3;\n}}}?\n?{()TIME;DD/MM/YY     hh:mm:ss;/TXN/TIME}?\n\nTID:\R?/MERCHANT()/TID?\nMID:\R?/MERCHANT()/MID?\nSTAN:\R?{()FMT;06;/TXN/STAN}?\nINVOICE:\R?{()FMT;06;/TXN/INVNO}?\n\n?{()TEXT_TABLE;CARD_NAME_ABBR;/CPAT()/LABEL}?\R?/TXN/ACCOUNT? ACCT\n \R?/iPAY_TRANS/START_LOOP?\L*?/iPAY_TRANS/END_LOOP??{{/TXN/TRACK2;;;{/TXN/TRACK2<=|4-1|;(c)}};{;;;{/TXN/PAN|4-1|;(m)}}}?\n\n?{{/TXN/VOID;;;\iVOID\n\4\W}}??{{/TXN/ECMm;1;;TELEPHONE };{/TXN/ECMm;2;;MAIL };{/TXN/ECMm;3;;INTERNET }}??{{/TXN/ECMt;1;;SINGLE\n};{/TXN/ECMt;2;;RECURRING\n};{/TXN/ECMt;3;;INSTALLMENT\n}}??{{/TXN/FUNC;PRCH;;PURCHASE};{/TXN/FUNC;CASH;;CASH OUT};{/TXN/FUNC;RFND;;REFUND};{/TXN/FUNC;AUTH;;PRE-AUTH};{/TXN/FUNC;COMP;;CHECKOUT}}?\R?{{/TXN/FUNC;CASH;;{()AMOUNT;/TXN/AMOUNT;0}};{;;;{()AMOUNT;()SUB;/TXN/AMOUNT;()SUM;/TXN/CASH;/TXN/PTIP;0}}}?\n?{{/TXN/FUNC;!CASH;;{{/TXN/CASH;;;{CASH;\R;()AMOUNT;/TXN/CASH;0;\n}}}}}??{{/TXN/PTIP;;;{TIP;\R;()AMOUNT;/TXN/PTIP;0;\n}}}??{{/TXN/TIP;;;{TIP;\R;()AMOUNT;/TXN/TIP;0;\n}}}??~TIP??{{/TXN/CASH;;;{{/TXN/FUNC;!CASH;;{ ;\R----------\n;TOTAL\R;{{~TIP;NULL;;{AUD ;()AMOUNT;/TXN/AMOUNT;0;\n}}}}}}};{/TXN/PTIP;;;{ ;\R----------\n;TOTAL\R;AUD ;()AMOUNT;/TXN/AMOUNT;0;\n}};{/TXN/TIP;;;{ ;\R----------\n;TOTAL\R;AUD ;()AMOUNT;()SUM;/TXN/AMOUNT;/TXN/TIP;0;\n}};}?\n?/iPAY_TRANS/VALUE_AUTHID?\n?~RESULT?\4------------------------------------------\n,VALUE_T:?{{~WHO;CUST;;{{/iECRD/CTRAILER;;;/iECRD/CTRAILER_READY};/iPAY_TRAILER/VALUE}};{/iECRD/MTRAILER;;;/iECRD/MTRAILER_READY};}??{{~WHO;MER;;{{/iECRD/MTRAILER_OK;;;{{~RESULT;{APP;SIG};;/iECRD/MTRAILER_OK_READY}}}}}}?\n,PRINT:[[,,{~CNT:/DUPLICATE()/RECEIPT/COUNT,:[[~WHO,CUST,{~CNT--:},]],:[[~WHO,MER,,[[/TXN/RESULT,T8,{~CNT--:},],[~CNT,>/MERCHANT()/MAX_DUP,{//DUPLICATE()/RECEIPT0>:,//DUPLICATE()/INVNO0>:,//DUPLICATE()/AMOUNT0>:,//DUPLICATE()/FUNC0>:,~CNT--:},]]]],//DUPLICATE()/RECEIPT(~CNT):[()PRINT_CONT,/iPAY_TRANS/VALUE_H1],//DUPLICATE()/RECEIPT(~CNT):[/DUPLICATE()/RECEIPT(~CNT),()PRINT_CONT,/iPAY_TRANS/VALUE_H2],//DUPLICATE()/MRECEIPT:[()PRINT_CONT,/iPAY_TRANS/VALUE],//DUPLICATE()/RECEIPT(~CNT)++:/DUPLICATE()/MRECEIPT,//DUPLICATE()/RECEIPT(~CNT)++:[()PRINT,/iPAY_TRANS/VALUE_T],/iPAY_PRINT_ERR/RECEIPT:/DUPLICATE()/RECEIPT(~CNT),//DUPLICATE()/INVNO(~CNT):/TXN/INVNO,//DUPLICATE()/AMOUNT(~CNT):[()SUM,/TXN/AMOUNT,/TXN/TIP],//DUPLICATE()/FUNC(~CNT):/TXN/FUNC,//TXN/POO_REVERSE>:,~CNT>:},]],PATH_TOSAF:[[,,{/(/MMER/ELECT)SAF/INDEX:/(/MMER/ELECT)SAF/COUNT,//(/MMER/ELECT)SAF()<:/TXN,//FROMBANK()/SAF_XMIT_TIME:[()SUM,()NOW,/MERCHANT()/SAF_TIMER]},]],PATH_A:[[,,{//TXN/MSGID:220},/iPAY_TRANS/PATH_TOSAF]],PATH:[[,,{//FROMBANK()/STAN++:,//FROMBANK()/STAN:[[/FROMBANK()/STAN,>999999,,1],/FROMBANK()/STAN],//TXN/STAN:/FROMBANK()/STAN,~ACCT:[[/TXN/ACCOUNT,SAVINGS,,10],[/TXN/ACCOUNT,CHEQUE,,20],30],//TXN/PROCCODE:[[/TXN/FUNC,RFND,,2],0],//TXN/PROCCODE++:[[/TXN/FUNC,CASH,,1],[/TXN/CASH,,,9],0],//TXN/PROCCODE++:[~ACCT,00],~ACCT>:,},[[/iECRD/MTRAILER,,{//iECRD/MTRAILER_READY:/iECRD/MTRAILER},],[/iECRD/MTRAILER_OK,,{//iECRD/MTRAILER_OK_READY:/iECRD/MTRAILER_OK},],[/iECRD/CTRAILER,,{//iECRD/CTRAILER_READY:/iECRD/CTRAILER},],[/iECRD/HEADER,,{//iECRD/HEADER_READY:/iECRD/HEADER},],[/iECRD/HEADER_OK,,{//iECRD/HEADER_OK_READY:/iECRD/HEADER_OK},],[/TXN/EFB,FBKV,,[[/TXN/ECMm,>0,{//TXN/RC:T00},~PATH_A],[/TXN/ECMm,>0,,iPAY_TXN_OK],[,,{//TXN/RC:T08},iPAY_TXN_SIG_MPRINT]]],[/TXN/EFB,,{//TXN/RC:T08},iPAY_TXN_PROCESSING_DELAY],[/TXN/FUNC,COMP,{//TXN/RC:T08},iPAY_TXN_PROCESSING_DELAY],[,,{/iPAY_SAF_START/RETURN:iPAY_TXN_REQ},iPAY_SAF_START]]]],SIGN:A1C87E39DEF2FE581E9F74F2B75A8460BA7C60FC}