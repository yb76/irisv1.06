{TYPE:DISPLAY,NAME:iPAY_STTL_REQ,GROUP:iPAY,VERSION:1.0,START_LOOP:[[,,{~CARD:7},]],LOOP:[[/STTL_DETAIL()/TRANSNUM(~CARD),>0,,[\i,()TEXT_TABLE,CARD_NAME,~CARD,\n\4\W,[[/STTL_DETAIL()/AUTHNUM(~CARD),>0,,[AUTH  ,()FMT,4,/STTL_DETAIL()/AUTHNUM(~CARD),*\R,()AMOUNT,/STTL_DETAIL()/AUTHAMT(~CARD),0,\n]]],[[/STTL_DETAIL()/PRCHNUM(~CARD),>0,,[SALE  ,()FMT,4,/STTL_DETAIL()/PRCHNUM(~CARD),\R,()AMOUNT,/STTL_DETAIL()/PRCHAMT(~CARD),0,\n]]],[[/STTL_DETAIL()/CASHNUM(~CARD),>0,,[CASH  ,()FMT,4,/STTL_DETAIL()/CASHNUM(~CARD),\R,()AMOUNT,/STTL_DETAIL()/CASHAMT(~CARD),0,\n]]],[[/STTL_DETAIL()/TIPSNUM(~CARD),>0,,[TIP   ,()FMT,4,/STTL_DETAIL()/TIPSNUM(~CARD),\R,()AMOUNT,/STTL_DETAIL()/TIPSAMT(~CARD),0,\n]]],[[/STTL_DETAIL()/RFNDNUM(~CARD),>0,,[REFUND,()FMT,4,/STTL_DETAIL()/RFNDNUM(~CARD),\R,()AMOUNT,/STTL_DETAIL()/RFNDAMT(~CARD),0,\n]]], \R----------\n,TOTAL ,()FMT,4,/STTL_DETAIL()/TRANSNUM(~CARD),\R,()AMOUNT,()SUM,/STTL_DETAIL()/TIPSAMT(~CARD),()SUM,/STTL_DETAIL()/CASHAMT(~CARD),()SUB,/STTL_DETAIL()/PRCHAMT(~CARD),/STTL_DETAIL()/RFNDAMT(~CARD),0,\n\n]]],END_LOOP:[[~CARD,7,{~CARD:5},LOOP],[~CARD,5,{~CARD:4},LOOP],[~CARD,4,{~CARD:1},LOOP],[~CARD,1,{~CARD:2},LOOP],[~CARD,2,{~CARD:6},LOOP]],VALUE:?/MERCHANT()/RECEIPT_HEADER?\C\4\WSETTLEMENT\n\n\4\W\C?/MERCHANT()/ADDR1?\n\C?{{/MERCHANT()/ADDR2;;;{/MERCHANT()/ADDR2;\n}}}?\C?{{/MERCHANT()/ADDR3;;;{/MERCHANT()/ADDR3;\n}}}?\n?{()TIME;DD/MM/YY     hh:mm:ss;~TIME}?\n\nTID:\R?/MERCHANT()/TID?\nMID:\R?/MERCHANT()/MID?\nSTAN:\R?{()FMT;06;/FROMBANK()/STAN}?\n\n\f\H\c23?{()TO_HEX;/iPAY_STTL_OK/FIELD63}?\n\n\4\W?~RESULT?\n\n\4------------------------------------------\n\4\WTerminal Totals:\n\4------------------------------------------\n\4\W?/iPAY_STTL_REQ/START_LOOP?\L?/iPAY_STTL_REQ/LOOP??/iPAY_STTL_REQ/END_LOOP??{\i;SUMMARY\n\4\W;AUTH  ;()FMT;4;{{/STTL_DETAIL()/AUTHNUM;;;/STTL_DETAIL()/AUTHNUM};0};*\R;()AMOUNT;/STTL_DETAIL()/AUTHAMT;0;\n;SALE  ;()FMT;4;{{/STTL_DETAIL()/PRCHNUM;;;/STTL_DETAIL()/PRCHNUM};0};\R;()AMOUNT;/STTL_DETAIL()/PRCHAMT;0;\n;CASH  ;()FMT;4;{{/STTL_DETAIL()/CASHNUM;;;/STTL_DETAIL()/CASHNUM};0};\R;()AMOUNT;/STTL_DETAIL()/CASHAMT;0;\n;TIP   ;()FMT;4;{{/STTL_DETAIL()/TIPSNUM;;;/STTL_DETAIL()/TIPSNUM};0};\R;()AMOUNT;/STTL_DETAIL()/TIPSAMT;0;\n;REFUND;()FMT;4;{{/STTL_DETAIL()/RFNDNUM;;;/STTL_DETAIL()/RFNDNUM};0};\R;()AMOUNT;/STTL_DETAIL()/RFNDAMT;0;\n; \R----------\n;TOTAL ;()FMT;4;/STTL_DETAIL()/TRANSNUM;\R;()AMOUNT;()SUM;/STTL_DETAIL()/TIPSAMT;()SUM;/STTL_DETAIL()/CASHAMT;()SUB;/STTL_DETAIL()/PRCHAMT;/STTL_DETAIL()/RFNDAMT;0;\n\n}?,MSG63:[[an,3,[()FMT,03,/STTL()/CR_PRCHNUM]],[an,12,[()FMT,012,/STTL()/CR_PRCHAMT]],[an,3,[()FMT,03,/STTL()/CR_RFNDNUM]],[an,12,[()FMT,012,/STTL()/CR_RFNDAMT]],[an,3,[()FMT,03,/STTL()/DR_PRCHNUM]],[an,12,[()FMT,012,/STTL()/DR_PRCHAMT]],[an,3,[()FMT,03,/STTL()/DR_RFNDNUM]],[an,12,[()FMT,012,/STTL()/DR_RFNDAMT]],[an,3,[()FMT,03,/STTL()/AUTHNUM]],[an,12,[()FMT,012,/STTL()/AUTHAMT]],[an,3,000],[an,12,000000000000]],MSG:[[0,[[()PREV_OBJECT,iPAY_STTL_NOK,,501],500]],[3,920000],[11,/FROMBANK()/STAN],[24,/MERCHANT/NII],[32,/MERCHANT/AIIC],[41,/MERCHANT()/TID],[42,/MERCHANT()/MID],[60,\a/FROMBANK()/BATCHNO],[63,~FIELD63],[64,[()MAC,/iPAY/KMACs,,()AS2805_GET]]],ANIMATION:[[INV,THIS,/iPAY/ANIMATION_A,1,C],[LARGE,iPAY_T5,223,2,C],[LARGE,iPAY_T5,200,3,C]],PATH:[[,,{:[[()PREV_OBJECT,!iPAY_STTL_NOK,{//FROMBANK()/STAN++:,//FROMBANK()/STAN:[[/FROMBANK()/STAN,>999999,,1],/FROMBANK()/STAN]},]],//FROMBANK()/BATCHNO:[[/FROMBANK()/BATCHNO,NULL,,1],/FROMBANK()/BATCHNO],:()IV_CLR,:[()AS2805_BCD_LEN,TRUE],~FIELD63:[()AS2805_MAKE_CUSTOM,~MSG63],~AS2805:[()AS2805_MAKE,~MSG],~AS2805:[[/MERCHANT/DATA_ENC,TRUE,{~IVOFB:0123456789ABCDEF,~IVOFB^:[0000000000,/FROMBANK()/STAN],:[()AS2805_OFB_PARAM,42,11,~IVOFB]},[()AS2805_OFB,/iPAY/KDs,~AS2805]],~AS2805],/iPAY_DW_TXN/PAINT:223,/iPAY_DW_TXN/RETURN_NOK:iPAY_STTL_NOK_COMMS,/iPAY_DW_TXN/RETURN:iPAY_STTL_RESP,/iPAY_DW_TXN/DONOTRETRY:[[()PREV_OBJECT,!iPAY_STTL_NOK,,TRUE],NULL],/iPAY_DW_TXN/PAYLOAD:~AS2805},iPAY_DW_TXN],[,LAST,{:[()CLR_TMP,]},]],SIGN:0B6DD011E7F65898A59193BD87D645A0526E8DC5}