{TYPE:DISPLAY,NAME:iPAY_SAF_REV,GROUP:iPAY,VERSION:1.0,MSG:[[0,/(/MMER/ELECT)SAF0/MSGID],[2,/(/MMER/ELECT)SAF0/PAN],[3,/(/MMER/ELECT)SAF0/PROCCODE],[4,/(/MMER/ELECT)SAF0/AMOUNT],[11,/(/MMER/ELECT)SAF0/STAN],[14,~EXPIRY],[22,[[/(/MMER/ELECT)SAF0/TRACK2,,,[[/(/MMER/ELECT)SAF0/PINBLOCK,,,21],22]],12]],[24,/MERCHANT/NII],[25,~POSCC],[32,/MERCHANT/AIIC],[35,/(/MMER/ELECT)SAF0/TRACK2],[41,/MERCHANT()/TID],[42,/MERCHANT()/MID],[54,\a/(/MMER/ELECT)SAF0/ADDAMT],[62,\a/(/MMER/ELECT)SAF0/INVNO],[64,[()MAC,/iPAY/KMACs,,()AS2805_GET]]],ANIMATION:[[INV,THIS,/iPAY/ANIMATION_A,1,C],[LARGE,iPAY_T5,225,2,C],[LARGE,iPAY_T5,200,3,C]],PATH:[[,INIT,{/iPAY_LOGON_CHECK/MSG:\aReversalProcessing},/iPAY_LOGON_CHECK/PATH_A],[,SER2_DATA,,/iPAY_LOGON_CHECK/PATH_B],[,,{~POSCC:[[/(/MMER/ELECT)SAF0/ECMm,[1,2],,8],[/(/MMER/ELECT)SAF0/ECMm,3,,48],0],~EXPIRY:[()MKTIME,YY,/(/MMER/ELECT)SAF0/EXPIRY|2-1|],~EXPIRY+:[()MKTIME,MM,/(/MMER/ELECT)SAF0/EXPIRY|4-3|],~EXPIRY+:[()MKTIME,DD,15],~EXPIRY:[()LEAP_ADJ,~EXPIRY],~EXPIRY:[[/(/MMER/ELECT)SAF0/EXPIRY,,,~EXPIRY],NULL],:[()AS2805_BCD_LEN,TRUE],:()IV_CLR,~AS2805:[()AS2805_MAKE,~MSG],~AS2805:[[/MERCHANT/DATA_ENC,TRUE,{~IVOFB:0123456789ABCDEF,~IVOFB^:[0000000000,/(/MMER/ELECT)SAF0/STAN],:[()AS2805_OFB_PARAM,42,11,~IVOFB]},[()AS2805_OFB,/iPAY/KDs,~AS2805]],~AS2805],//(/MMER/ELECT)SAF0/MSGID:401,//(/MMER/ELECT)SAF0/RSPID:410,/iPAY_DW_TXN/PAINT:225,/iPAY_DW_TXN/RETURN_NOK:iPAY_SAF_RESP,/iPAY_DW_TXN/RETURN:iPAY_SAF_RESP,/iPAY_DW_TXN/DONOTRETRY>:,/iPAY_DW_TXN/PAYLOAD:~AS2805},iPAY_DW_TXN],[,LAST,{:[()CLR_TMP,]},]],SIGN:058BFFBF62BD7999943C429C6AA5E5460CDD36F0}